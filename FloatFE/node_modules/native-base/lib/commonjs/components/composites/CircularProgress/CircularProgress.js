var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _lodash=_interopRequireDefault(require("lodash.get"));var _react=_interopRequireDefault(require("react"));var _reactNative=require("react-native");var _native=_interopRequireDefault(require("styled-components/native"));var _styledSystem=require("styled-system");var _hooks=require("../../../hooks");var _utils=require("../../../utils");var _Box=_interopRequireDefault(require("../../primitives/Box"));var _theme=require("../../../theme");var _this=this,_jsxFileName="/Users/himanshusatija/projects/nativebase-v3/src/components/composites/CircularProgress/CircularProgress.tsx";var StyleAnimatedView=(0,_native.default)(_reactNative.Animated.View)(_styledSystem.color,_styledSystem.border);var CircularProgress=function CircularProgress(_ref,ref){var value=_ref.value,isIndeterminate=_ref.isIndeterminate,max=_ref.max,min=_ref.min,props=(0,_objectWithoutProperties2.default)(_ref,["value","isIndeterminate","max","min"]);var theme=(0,_hooks.useTheme)();var isDomUsable=(0,_utils.canUseDom)();if(min){value=value-min;}var sizeProps;var newProps=(0,_hooks.useThemeProps)('CircularProgress',props);var _themeTools$extractIn=_theme.themeTools.extractInObject(props,['size']),_themeTools$extractIn2=(0,_slicedToArray2.default)(_themeTools$extractIn,2),remainingProps=_themeTools$extractIn2[1];if(!newProps.size){sizeProps={height:newProps.height,width:newProps.width};}else{sizeProps={height:newProps.size,width:newProps.size};}var themeHeight=(0,_lodash.default)(theme,'space.'+sizeProps.height);var themeWidth=(0,_lodash.default)(theme,'space.'+sizeProps.width);var styleSize={height:themeHeight?parseInt(themeHeight.slice(themeHeight.Length,-2),10):sizeProps.height,width:themeWidth?parseInt(themeWidth.slice(themeWidth.Length,-2),10):sizeProps.width};var defaultThickness=newProps.thickness;var degree=new _reactNative.Animated.Value(0);if(isIndeterminate){if(isDomUsable){_reactNative.Animated.loop(_reactNative.Animated.timing(degree,{toValue:1,duration:600,easing:_reactNative.Easing.linear,useNativeDriver:false})).start();}}var _React$useState=_react.default.useState(0),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),viewHeight=_React$useState2[0],setViewHeight=_React$useState2[1];var layout=function layout(e){var height=e.nativeEvent.layout.height;setViewHeight(height);};var defaultStyling=(0,_extends2.default)({borderBottomLeftRadius:viewHeight/2,borderBottomRightRadius:viewHeight/2,borderTopLeftRadius:viewHeight/2,borderTopRightRadius:viewHeight/2,borderLeftWidth:defaultThickness,borderBottomWidth:defaultThickness,position:'absolute',borderLeftColor:'transparent',borderBottomColor:'transparent'},styleSize);var styles=_reactNative.StyleSheet.create({firstProgressLayer:(0,_extends2.default)({borderTopWidth:defaultThickness,borderRightWidth:defaultThickness},defaultStyling,{transform:[{rotateZ:'-135deg'}]}),secondProgressLayer:(0,_extends2.default)({borderTopWidth:defaultThickness,borderRightWidth:defaultThickness},defaultStyling,{transform:[{rotateZ:'45deg'}]}),offsetLayer:(0,_extends2.default)({borderTopWidth:defaultThickness,borderRightWidth:defaultThickness},defaultStyling,{borderRadius:viewHeight/2,transform:[{rotateZ:'-135deg'}]}),animateStyle:(0,_extends2.default)({borderTopWidth:defaultThickness,borderRightWidth:defaultThickness},defaultStyling,{transform:[{rotateZ:degree.interpolate({inputRange:[0,1],outputRange:['0deg','360deg']})}]})});var halfSide=(max?min?max-min:max:100)/2;var propStyle=function propStyle(percent,base_degrees){var rotateBy=base_degrees+percent*180/halfSide;return{transform:[{rotateZ:rotateBy+'deg'}]};};var renderThirdLayer=function renderThirdLayer(percent){if(percent>halfSide){return _react.default.createElement(_Box.default,{borderTopColor:newProps.color,borderRightColor:newProps.color,style:[styles.secondProgressLayer,propStyle(percent-halfSide,45)],__self:_this,__source:{fileName:_jsxFileName,lineNumber:128,columnNumber:9}});}else{return _react.default.createElement(_Box.default,{borderTopColor:newProps.trackColor,borderRightColor:newProps.trackColor,style:styles.offsetLayer,__self:_this,__source:{fileName:_jsxFileName,lineNumber:139,columnNumber:9}});}};var firstProgressLayerStyle;if(value>halfSide){firstProgressLayerStyle=propStyle(halfSide,-135);}else{firstProgressLayerStyle=propStyle(value,-135);}return _react.default.createElement(_Box.default,(0,_extends2.default)({},sizeProps,{rounded:viewHeight/2,borderWidth:defaultThickness,borderColor:newProps.trackColor,justifyContent:"center",alignItems:"center"},remainingProps,{ref:ref,accessible:true,accessibilityRole:"progressbar",accessibilityValue:{min:min,max:max,now:value},__self:_this,__source:{fileName:_jsxFileName,lineNumber:155,columnNumber:5}}),!isIndeterminate?_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_Box.default,{onLayout:layout,borderTopColor:newProps.color,borderRightColor:newProps.color,style:[styles.firstProgressLayer,firstProgressLayerStyle],__self:_this,__source:{fileName:_jsxFileName,lineNumber:174,columnNumber:11}}),renderThirdLayer(value),_react.default.createElement(_Box.default,{_text:newProps._text,__self:_this,__source:{fileName:_jsxFileName,lineNumber:181,columnNumber:11}},remainingProps.children)):_react.default.createElement(StyleAnimatedView,{onLayout:layout,borderTopColor:newProps.color,borderRightColor:newProps.color,style:styles.animateStyle,__self:_this,__source:{fileName:_jsxFileName,lineNumber:184,columnNumber:9}}));};var _default=_react.default.memo(_react.default.forwardRef(CircularProgress));exports.default=_default;
//# sourceMappingURL=CircularProgress.js.map