var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _react=_interopRequireWildcard(require("react"));var _Popper=require("../Popper");var _utils=require("../../../utils");var _hooks=require("../../../hooks");var _PopoverContext=require("./PopoverContext");var _Box=_interopRequireDefault(require("../../primitives/Box"));var _Backdrop=_interopRequireDefault(require("../Backdrop"));var _focus=require("@react-native-aria/focus");var _Transitions=require("../Transitions");var _reactNative=require("react-native");var _utils2=require("@react-aria/utils");var _Overlay=require("../../primitives/Overlay");var _this=this,_jsxFileName="/Users/himanshusatija/projects/nativebase-v3/src/components/composites/Popover/Popover.tsx";var Popover=function Popover(_ref,ref){var onOpen=_ref.onOpen,trigger=_ref.trigger,onClose=_ref.onClose,isOpenProp=_ref.isOpen,children=_ref.children,defaultIsOpen=_ref.defaultIsOpen,initialFocusRef=_ref.initialFocusRef,finalFocusRef=_ref.finalFocusRef,_ref$trapFocus=_ref.trapFocus,trapFocus=_ref$trapFocus===void 0?true:_ref$trapFocus,rest=(0,_objectWithoutProperties2.default)(_ref,["onOpen","trigger","onClose","isOpen","children","defaultIsOpen","initialFocusRef","finalFocusRef","trapFocus"]);var triggerRef=_react.default.useRef(null);var mergedRef=(0,_utils.mergeRefs)([triggerRef]);var _useControllableState=(0,_hooks.useControllableState)({value:isOpenProp,defaultValue:defaultIsOpen,onChange:function onChange(value){value?onOpen&&onOpen():onClose&&onClose();}}),_useControllableState2=(0,_slicedToArray2.default)(_useControllableState,2),isOpen=_useControllableState2[0],setIsOpen=_useControllableState2[1];var _React$useState=_react.default.useState(false),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),bodyMounted=_React$useState2[0],setBodyMounted=_React$useState2[1];var _React$useState3=_react.default.useState(false),_React$useState4=(0,_slicedToArray2.default)(_React$useState3,2),headerMounted=_React$useState4[0],setHeaderMounted=_React$useState4[1];var popoverContentId=(0,_utils2.useId)()+"-content";var headerId=popoverContentId+"-header";var bodyId=popoverContentId+"-body";var handleOpen=_react.default.useCallback(function(){setIsOpen(true);},[setIsOpen]);var updatedTrigger=function updatedTrigger(){return trigger({'ref':mergedRef,'onPress':handleOpen,'aria-expanded':isOpen?true:false,'aria-controls':isOpen?popoverContentId:undefined,'aria-haspopup':true},{open:isOpen});};var handleClose=function handleClose(){setIsOpen(false);};return _react.default.createElement(_Box.default,{ref:ref,__self:_this,__source:{fileName:_jsxFileName,lineNumber:69,columnNumber:5}},updatedTrigger(),_react.default.createElement(_Overlay.Overlay,{isOpen:isOpen,onRequestClose:handleClose,useRNModalOnAndroid:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:71,columnNumber:7}},_react.default.createElement(_Transitions.PresenceTransition,{initial:{opacity:0},animate:{opacity:1,transition:{duration:150}},exit:{opacity:0,scale:0.95,transition:{duration:100}},visible:isOpen,style:_reactNative.StyleSheet.absoluteFill,__self:_this,__source:{fileName:_jsxFileName,lineNumber:72,columnNumber:9}},_react.default.createElement(_Popper.Popper,(0,_extends2.default)({onClose:handleClose,triggerRef:triggerRef},rest,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:79,columnNumber:11}}),_react.default.createElement(_Backdrop.default,{onPress:handleClose,bg:"transparent",__self:_this,__source:{fileName:_jsxFileName,lineNumber:80,columnNumber:13}}),_react.default.createElement(_PopoverContext.PopoverContext.Provider,{value:{onClose:handleClose,initialFocusRef:initialFocusRef,finalFocusRef:finalFocusRef,popoverContentId:popoverContentId,bodyId:bodyId,headerId:headerId,headerMounted:headerMounted,bodyMounted:bodyMounted,setBodyMounted:setBodyMounted,setHeaderMounted:setHeaderMounted},__self:_this,__source:{fileName:_jsxFileName,lineNumber:81,columnNumber:13}},_react.default.createElement(_focus.FocusScope,{contain:trapFocus,restoreFocus:true,autoFocus:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:95,columnNumber:15}},children))))));};var _default=(0,_react.memo)((0,_react.forwardRef)(Popover));exports.default=_default;
//# sourceMappingURL=Popover.js.map