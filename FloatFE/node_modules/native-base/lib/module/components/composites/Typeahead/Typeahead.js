var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.Typeahead=void 0;var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _react=_interopRequireDefault(require("react"));var _button=require("@react-native-aria/button");var _combobox=require("@react-stately/combobox");var _combobox2=require("@react-native-aria/combobox");var _listbox=require("@react-native-aria/listbox");var _reactNative=require("react-native");var _collections=require("@react-stately/collections");var _Box=_interopRequireDefault(require("../../primitives/Box"));var _Pressable=require("../../primitives/Pressable");var _Text=_interopRequireDefault(require("../../primitives/Text"));var _tools=require("../../../theme/tools");var _types=require("./types");var _Input=require("../../primitives/Input");var _hooks=require("../../../hooks");var _this=this,_jsxFileName="/Users/himanshusatija/projects/nativebase-v3/src/components/composites/Typeahead/Typeahead.tsx";var Typeahead=_react.default.forwardRef(function(_ref,ref){var onSelectedItemChange=_ref.onSelectedItemChange,options=_ref.options,renderItem=_ref.renderItem,getOptionLabel=_ref.getOptionLabel,getOptionKey=_ref.getOptionKey,onChange=_ref.onChange,numberOfItems=_ref.numberOfItems,rest=(0,_objectWithoutProperties2.default)(_ref,["onSelectedItemChange","options","renderItem","getOptionLabel","getOptionKey","onChange","numberOfItems"]);return _react.default.createElement(ComboBoxImplementation,(0,_extends2.default)({},rest,{onSelectionChange:onSelectedItemChange,items:numberOfItems!==undefined?options.slice(0,numberOfItems):options,onInputChange:onChange,ref:ref,__self:_this,__source:{fileName:_jsxFileName,lineNumber:31,columnNumber:7}}),function(item){if(typeof item!=='string'&&getOptionLabel===undefined){throw new Error('Please use getOptionLabel prop');}if(item.id===undefined&&getOptionKey===undefined){throw new Error('Please use getOptionKey prop');}var optionLabel=getOptionLabel?getOptionLabel(item):item;var optionKey=getOptionKey?getOptionKey(item):item.id!==undefined?item.id:optionLabel;return _react.default.createElement(_collections.Item,{textValue:optionLabel,key:optionKey,__self:_this,__source:{fileName:_jsxFileName,lineNumber:59,columnNumber:13}},renderItem?renderItem(item):_react.default.createElement(_Box.default,{p:2,justifyContent:"center",__self:_this,__source:{fileName:_jsxFileName,lineNumber:63,columnNumber:17}},_react.default.createElement(_Text.default,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:64,columnNumber:19}},optionLabel)));});});exports.Typeahead=Typeahead;var ComboBoxImplementation=_react.default.forwardRef(function(props,ref){var _extractInObject=(0,_tools.extractInObject)(props,_types.layoutPropsList),_extractInObject2=(0,_slicedToArray2.default)(_extractInObject,1),layoutProps=_extractInObject2[0];var state=(0,_combobox.useComboBoxState)(props);var triggerRef=_react.default.useRef(null);var inputRef=_react.default.useRef(null);var listBoxRef=_react.default.useRef(null);var popoverRef=_react.default.useRef(null);var _useComboBox=(0,_combobox2.useComboBox)((0,_extends2.default)({},props,{inputRef:inputRef,buttonRef:triggerRef,listBoxRef:listBoxRef,popoverRef:popoverRef,menuTrigger:'input'}),state),triggerProps=_useComboBox.buttonProps,inputProps=_useComboBox.inputProps,listBoxProps=_useComboBox.listBoxProps,labelProps=_useComboBox.labelProps;var toggleIconSetter=function toggleIconSetter(){if(typeof props.toggleIcon==='function')return props.toggleIcon({isOpen:state.isOpen});return props.toggleIcon;};var _useButton=(0,_button.useButton)(triggerProps),buttonProps=_useButton.buttonProps;return _react.default.createElement(_Box.default,(0,_extends2.default)({flexDirection:"row"},layoutProps,{ref:ref,__self:_this,__source:{fileName:_jsxFileName,lineNumber:113,columnNumber:7}}),_react.default.createElement(_Box.default,{flex:1,__self:_this,__source:{fileName:_jsxFileName,lineNumber:114,columnNumber:9}},props.label&&_react.default.createElement(_Text.default,(0,_extends2.default)({},labelProps,{pb:1,__self:_this,__source:{fileName:_jsxFileName,lineNumber:116,columnNumber:13}}),props.label),_react.default.createElement(_Input.Input,(0,_extends2.default)({},inputProps,{ref:inputRef,InputRightElement:_react.default.createElement(_Pressable.Pressable,(0,_extends2.default)({},buttonProps,{ref:triggerRef,__self:_this,__source:{fileName:_jsxFileName,lineNumber:125,columnNumber:15}}),toggleIconSetter()),__self:_this,__source:{fileName:_jsxFileName,lineNumber:120,columnNumber:11}})),state.isOpen&&_react.default.createElement(ListBoxPopup,(0,_extends2.default)({},listBoxProps,{listBoxRef:listBoxRef,popoverRef:popoverRef,state:state,label:props.label,__self:_this,__source:{fileName:_jsxFileName,lineNumber:132,columnNumber:13}}))));});function ListBoxPopup(props){var _this2=this;var popoverRef=props.popoverRef,listBoxRef=props.listBoxRef,state=props.state,dropdownHeight=props.dropdownHeight,label=props.label;var _useListBox=(0,_listbox.useListBox)({label:label,autoFocus:state.focusStrategy,disallowEmptySelection:true},state,listBoxRef),listBoxProps=_useListBox.listBoxProps;return _react.default.createElement(_Box.default,{ref:popoverRef,__self:this,__source:{fileName:_jsxFileName,lineNumber:168,columnNumber:5}},_react.default.createElement(_Box.default,{position:"absolute",width:"100%",maxHeight:dropdownHeight!=null?dropdownHeight:200,__self:this,__source:{fileName:_jsxFileName,lineNumber:169,columnNumber:7}},_react.default.createElement(_reactNative.ScrollView,(0,_extends2.default)({},listBoxProps,{keyboardShouldPersistTaps:"handled",ref:function ref(node){if(_reactNative.Platform.OS==='web'){listBoxRef.current=(0,_reactNative.findNodeHandle)(node);}else{listBoxRef.current=node;}},__self:this,__source:{fileName:_jsxFileName,lineNumber:170,columnNumber:9}}),(0,_toConsumableArray2.default)(state.collection).map(function(item){return _react.default.createElement(Option,{key:item.key,item:item,state:state,__self:_this2,__source:{fileName:_jsxFileName,lineNumber:182,columnNumber:13}});}))));}function Option(_ref2){var item=_ref2.item,state=_ref2.state;var searchItemStyle=(0,_hooks.useThemeProps)('TypeAheadSearchItem',{});var ref=_react.default.useRef(null);var isDisabled=state.disabledKeys.has(item.key);var isSelected=state.selectionManager.isSelected(item.key);var isFocused=state.selectionManager.focusedKey===item.key;var _useOption=(0,_listbox.useOption)({key:item.key,isDisabled:isDisabled,isSelected:isSelected,shouldFocusOnHover:true,shouldUseVirtualFocus:true},state,ref),optionProps=_useOption.optionProps;var backgroundColor=searchItemStyle.backgroundColor;var opacity=1;if(isSelected){backgroundColor=searchItemStyle._focus.backgroundColor;}else if(isFocused){backgroundColor=searchItemStyle._focus.backgroundColor;}else if(isDisabled){opacity=0.6;backgroundColor=searchItemStyle._disabled.backgroundColor;}return _react.default.createElement(_Pressable.Pressable,(0,_extends2.default)({},optionProps,{opacity:opacity,cursor:isDisabled?_reactNative.Platform.OS==='web'?'not-allowed':null:null,backgroundColor:backgroundColor,ref:ref,__self:this,__source:{fileName:_jsxFileName,lineNumber:223,columnNumber:5}}),item.rendered);}
//# sourceMappingURL=Typeahead.js.map