var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _react=_interopRequireDefault(require("react"));var _Stack=require("../../primitives/Stack");var _hooks=require("../../../hooks");var _FormControl=require("../FormControl");var _reactNative=require("react-native");var _Context=require("./Context");var _theme=require("../../../theme");var _this=this,_jsxFileName="/Users/himanshusatija/projects/nativebase-v3/src/components/composites/PinInput/PinInput.tsx";var PinInput=function PinInput(_ref,ref){var children=_ref.children,props=(0,_objectWithoutProperties2.default)(_ref,["children"]);var _themeTools$extractIn=_theme.themeTools.extractInObject(props,['p','px','py','pt','pb','pl','pr']),_themeTools$extractIn2=(0,_slicedToArray2.default)(_themeTools$extractIn,2),padding=_themeTools$extractIn2[0],remProps=_themeTools$extractIn2[1];var _useThemeProps=(0,_hooks.useThemeProps)('PinInput',remProps),manageFocus=_useThemeProps.manageFocus,defaultValue=_useThemeProps.defaultValue,value=_useThemeProps.value,space=_useThemeProps.space,onChange=_useThemeProps.onChange,newProps=(0,_objectWithoutProperties2.default)(_useThemeProps,["manageFocus","defaultValue","value","space","onChange"]);var formControlContext=(0,_FormControl.useFormControlContext)();var RefList=[];var setRefList=function setRefList(ref,index){RefList[index]=ref;};var _React$useState=_react.default.useState(value||defaultValue),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),pinInputValue=_React$useState2[0],setPinInputValue=_React$useState2[1];var handleChange=function handleChange(newValue,fieldIndex){var temp=pinInputValue&&(0,_toConsumableArray2.default)(pinInputValue)||[];temp[fieldIndex]=newValue;value===undefined&&setPinInputValue(temp.join(''));onChange&&onChange(temp.join(''));if(newValue===''&&manageFocus&&fieldIndex-1>-1)RefList[fieldIndex-1].current.focus();else if(newValue&&manageFocus&&fieldIndex+1<RefList.length)RefList[fieldIndex+1].current.focus();return temp.join('');};var handleMultiValueChange=function handleMultiValueChange(newValue,fieldIndex){var pinFieldLength=RefList.length;var newValueLength=newValue.length;if(newValueLength>=pinFieldLength&&newValueLength>2){var splicedValue=newValue?(0,_toConsumableArray2.default)(newValue):[];splicedValue.splice(pinFieldLength);RefList[pinFieldLength-1].current.focus();setPinInputValue(splicedValue.join(''));onChange&&onChange(splicedValue.join(''));}if(_reactNative.Platform.OS!=='ios'){var temp=pinInputValue?(0,_toConsumableArray2.default)(pinInputValue):[];if(newValue===''){temp=temp.filter(function(_n,i){return i!==fieldIndex;});if(manageFocus&&fieldIndex-1>-1)RefList[fieldIndex-1].current.focus();}else{temp[fieldIndex]=JSON.stringify(parseInt(newValue,10)%10);if(manageFocus&&fieldIndex+1<RefList.length)RefList[fieldIndex+1].current.focus();}value===undefined&&setPinInputValue(temp.join(''));onChange&&onChange(temp.join(''));}};var indexSetter=function indexSetter(allChildren){var pinInputFiledCounter=-1;return _react.default.Children.map(allChildren,function(child){pinInputFiledCounter++;return _react.default.cloneElement(child,{fieldIndex:pinInputFiledCounter},child.props.children);});};_react.default.useEffect(function(){if(value!==undefined&&value!=pinInputValue)setPinInputValue(value);},[value,pinInputValue,setPinInputValue]);return _react.default.createElement(_Context.PinInputContext.Provider,{value:(0,_extends2.default)({},formControlContext,newProps,{setRefList:setRefList,handleChange:handleChange,handleMultiValueChange:handleMultiValueChange,value:pinInputValue}),__self:_this,__source:{fileName:_jsxFileName,lineNumber:95,columnNumber:5}},children&&_react.default.createElement(_Stack.HStack,(0,_extends2.default)({flexDirection:"row",space:space},padding,{ref:ref,__self:_this,__source:{fileName:_jsxFileName,lineNumber:106,columnNumber:9}}),indexSetter(children)));};var _default=_react.default.memo(_react.default.forwardRef(PinInput));exports.default=_default;
//# sourceMappingURL=PinInput.js.map