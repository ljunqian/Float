{"version":3,"sources":["PinInput.tsx"],"names":["PinInput","ref","children","props","themeTools","extractInObject","padding","remProps","manageFocus","defaultValue","value","space","onChange","newProps","formControlContext","RefList","setRefList","index","React","useState","pinInputValue","setPinInputValue","handleChange","newValue","fieldIndex","temp","undefined","join","current","focus","length","handleMultiValueChange","pinFieldLength","newValueLength","splicedValue","splice","Platform","OS","filter","_n","i","JSON","stringify","parseInt","indexSetter","allChildren","pinInputFiledCounter","Children","map","child","cloneElement","useEffect","memo","forwardRef"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { HStack } from '../../primitives/Stack';\nimport { useThemeProps } from '../../../hooks';\nimport type { IPinInputProps } from './types';\nimport { useFormControlContext } from '../FormControl';\nimport { Platform } from 'react-native';\nimport { PinInputContext } from './Context';\nimport { themeTools } from '../../../theme';\n\nconst PinInput = ({ children, ...props }: IPinInputProps, ref?: any) => {\n  let [padding, remProps] = themeTools.extractInObject(props, [\n    'p',\n    'px',\n    'py',\n    'pt',\n    'pb',\n    'pl',\n    'pr',\n  ]);\n  const {\n    manageFocus,\n    defaultValue,\n    value,\n    space,\n    onChange,\n    ...newProps\n  } = useThemeProps('PinInput', remProps);\n  const formControlContext = useFormControlContext();\n\n  const RefList: Array<any> = [];\n  const setRefList = (ref: any, index: number) => {\n    RefList[index] = ref;\n  };\n  const [pinInputValue, setPinInputValue] = React.useState(\n    value || defaultValue\n  );\n  const handleChange = (newValue: string, fieldIndex: number) => {\n    let temp = (pinInputValue && [...pinInputValue]) || [];\n    temp[fieldIndex] = newValue;\n    value === undefined && setPinInputValue(temp.join(''));\n    onChange && onChange(temp.join(''));\n    if (newValue === '' && manageFocus && fieldIndex - 1 > -1)\n      RefList[fieldIndex - 1].current.focus();\n    else if (newValue && manageFocus && fieldIndex + 1 < RefList.length)\n      RefList[fieldIndex + 1].current.focus();\n    return temp.join('');\n  };\n  const handleMultiValueChange = (newValue: string, fieldIndex: number) => {\n    const pinFieldLength = RefList.length;\n    const newValueLength = newValue.length;\n    if (newValueLength >= pinFieldLength && newValueLength > 2) {\n      let splicedValue = newValue ? [...newValue] : [];\n      splicedValue.splice(pinFieldLength);\n      RefList[pinFieldLength - 1].current.focus();\n      setPinInputValue(splicedValue.join(''));\n      onChange && onChange(splicedValue.join(''));\n    }\n\n    if (Platform.OS !== 'ios') {\n      let temp = pinInputValue ? [...pinInputValue] : [];\n      if (newValue === '') {\n        // Handling Backward focus.\n        temp = temp.filter((_n, i) => i !== fieldIndex);\n        if (manageFocus && fieldIndex - 1 > -1)\n          RefList[fieldIndex - 1].current.focus();\n      } else {\n        temp[fieldIndex] = JSON.stringify(parseInt(newValue, 10) % 10);\n        if (manageFocus && fieldIndex + 1 < RefList.length)\n          RefList[fieldIndex + 1].current.focus();\n      }\n      value === undefined && setPinInputValue(temp.join(''));\n      onChange && onChange(temp.join(''));\n    }\n  };\n\n  const indexSetter = (allChildren: JSX.Element | JSX.Element[]) => {\n    let pinInputFiledCounter = -1;\n    return React.Children.map(allChildren, (child: JSX.Element) => {\n      pinInputFiledCounter++;\n      return React.cloneElement(\n        child,\n        {\n          fieldIndex: pinInputFiledCounter,\n        },\n        child.props.children\n      );\n    });\n  };\n\n  React.useEffect(() => {\n    if (value !== undefined && value != pinInputValue) setPinInputValue(value);\n  }, [value, pinInputValue, setPinInputValue]);\n\n  return (\n    <PinInputContext.Provider\n      value={{\n        ...formControlContext,\n        ...newProps,\n        setRefList,\n        handleChange,\n        handleMultiValueChange,\n        value: pinInputValue,\n      }}\n    >\n      {children && (\n        <HStack flexDirection=\"row\" space={space} {...padding} ref={ref}>\n          {indexSetter(children)}\n        </HStack>\n      )}\n    </PinInputContext.Provider>\n  );\n};\n\nexport default React.memo(React.forwardRef(PinInput));\n"]}